<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Today Migraine Risk</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  :root{color-scheme:dark}
  .gauge{--p:50;--c:#34d399;background:conic-gradient(var(--c) calc(var(--p)*1%),rgba(255,255,255,.08) 0)}
  .gauge::after{content:"";position:absolute;inset:12px;border-radius:9999px;background:#111;border:1px solid rgba(255,255,255,.08)}
</style>
</head>
<body class="bg-neutral-950 text-neutral-100 p-5 max-w-md mx-auto">
<header class="flex items-center justify-between mb-6">
  <div class="flex items-center gap-2">
    <button id="menuBtn"
      class="w-9 h-9 rounded-xl bg-gradient-to-br from-cyan-400 to-violet-400 grid place-items-center 
         border border-white/10 hover:brightness-110 active:scale-95 transition"
    aria-label="Open menu">
    <!-- Hamburger (3 lines) -->
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M4 7h16M4 12h16M4 17h16" stroke="#0b0c10" stroke-width="2" stroke-linecap="round"/>
    </svg>
</button>
    <div><div class="font-semibold">Today Migraine Risk</div><div id="updated" class="text-xs text-neutral-400">Updated â€”</div></div>
  </div>
  <button id="refresh" class="px-3 py-1.5 text-sm rounded-xl bg-neutral-800 border border-neutral-700">Refresh</button>
</header>

<!-- Gauge -->
<div class="rounded-2xl border border-neutral-800 bg-neutral-900 p-6 grid place-items-center mb-4">
  <div id="gauge" class="gauge w-44 h-44 rounded-full grid place-items-center relative">
    <div class="text-center relative z-10">
      <div id="pct" class="text-4xl font-bold">--%</div>
      <div id="band" class="text-sm text-neutral-400">â€”</div>
    </div>
  </div>
</div>

<!-- Drivers, Actions, History -->
<div class="rounded-2xl border border-neutral-800 bg-neutral-900 p-4 space-y-4">
  <section>
    <div class="text-xs uppercase tracking-widest text-neutral-400">Top drivers</div>
    <div id="chips" class="mt-2 flex flex-wrap gap-2"></div>
  </section>
  <section>
    <div class="text-xs uppercase tracking-widest text-neutral-400">Recommended actions</div>
    <div id="actions" class="mt-2 grid gap-2"></div>
  </section>
  <section>
    <div class="text-xs uppercase tracking-widest text-neutral-400 flex items-center gap-2">
      <span>History</span>
      <span>(Migraine Occurrence)</span>
    </div>

    <div id="historySummary" class="mt-2 flex gap-2">
      <div class="rounded-lg border border-neutral-800 bg-neutral-900 px-3 py-2 text-sm"><span class="text-neutral-400">24h:</span> <span id="h24" class="font-semibold">0</span></div>
      <div class="rounded-lg border border-neutral-800 bg-neutral-900 px-3 py-2 text-sm"><span class="text-neutral-400">7d:</span>  <span id="h7"  class="font-semibold">0</span></div>
      <div class="rounded-lg border border-neutral-800 bg-neutral-900 px-3 py-2 text-sm"><span class="text-neutral-400">30d:</span> <span id="h30" class="font-semibold">0</span></div>
    </div>
    <div class="mt-3 text-xs uppercase tracking-widest text-neutral-400">Recent events</div>
    <div id="historyList" class="mt-2 grid gap-1 text-sm text-neutral-300"></div>
  </section>
</div>

<div id="toast" class="fixed left-1/2 -translate-x-1/2 bottom-4 opacity-0 transition-opacity bg-neutral-900 border border-neutral-800 px-3 py-2 rounded-xl text-sm">Action logged</div>

<script>
/* ----- mock data ----- */
const DATA=[{p:.18,f:[{k:'hrv',i:.38,d:'down'},{k:'stress',i:.22,d:'up'},{k:'work',i:.17,d:'up'}]},
            {p:.46,f:[{k:'work',i:.32,d:'up'},{k:'stress',i:.29,d:'up'},{k:'hrv',i:.19,d:'down'}]},
            {p:.76,f:[{k:'stress',i:.44,d:'up'},{k:'work',i:.19,d:'up'},{k:'hrv',i:.16,d:'down'}]}];
const ACTIONS={"stress:up":["2-min box breathing","Stand + stretch","Silence phone 10 min"],
               "work:up":["Reschedule one task","Drink water","Micro-break 2 min"],
               "hrv:down":["Good recovery â€” maintain pace","Avoid workload spikes"]};
const now=Date.now(), d=n=>new Date(now-n*864e5).toISOString(), h=n=>new Date(now-n*36e5).toISOString();
const MIGRAINES=[h(3),h(22),d(2),d(5),d(9),d(15),d(21),d(27),d(29)];

/* ----- el refs ----- */
const gauge=document.getElementById("gauge"), pct=document.getElementById("pct"), band=document.getElementById("band");
const updated=document.getElementById("updated"), chips=document.getElementById("chips"), actions=document.getElementById("actions");
const h24=document.getElementById("h24"), h7=document.getElementById("h7"), h30=document.getElementById("h30"), historyList=document.getElementById("historyList");
const toast=document.getElementById("toast"); let i=0, selected=null;

/* ----- render ----- */
function load(){
  const d=DATA[i++%DATA.length], r=Math.round(d.p*100);
  const ring=d.p>=.7?"#f87171":d.p>=.3?"#fbbf24":"#34d399", label=d.p>=.7?"High":d.p>=.3?"Elevated":"Low";
  gauge.style.setProperty("--p",r); gauge.style.setProperty("--c",ring);
  pct.textContent=r+"%"; band.textContent=label+" risk next hour"; updated.textContent="Updated just now";
  selected=null; actions.innerHTML="";         // <- no preselect on refresh
  renderChips(d.f); renderHistory();
}
function renderChips(list){
  chips.innerHTML="";
  list.forEach(f=>{
    const key=f.k+":"+f.d, imp=Math.round(f.i*100);
    const tone=imp>35?"text-red-400":imp>20?"text-yellow-300":"text-green-400";
    const emoji={hrv:"ğŸ’“",stress:"ğŸ˜®â€ğŸ’¨",work:"ğŸ“…"}[f.k], arrow=f.d==="up"?"â†‘":"â†“";
    const btn=document.createElement("button");
    btn.className=`px-3 py-1.5 rounded-full text-sm flex items-center gap-1 border transition hover:scale-105
      ${key===selected?"border-cyan-300 bg-cyan-300/10 shadow-[0_0_10px_rgba(94,234,212,.35)]":"border-neutral-800 bg-neutral-800/60 hover:bg-neutral-800"}`;
    btn.innerHTML=`${emoji} <span class="font-medium">${name(f.k)}</span> <span class="${tone}">${arrow} ${imp}%</span>`;
    btn.onclick=()=>select(key, list); chips.appendChild(btn);
  });
}
function select(key, list){
  selected=key; actions.innerHTML="";
  (ACTIONS[key]||["Take a break","Hydrate","Dim lights"]).forEach(t=>{
    const pill=document.createElement("div");
    pill.className="px-3 py-2 rounded-xl border border-neutral-800 bg-neutral-900 text-sm";
    pill.textContent=t; pill.onclick=toastOnce; actions.appendChild(pill);
  });
  renderChips(list); // re-render to show highlight only after click
}
function renderHistory(){
  const ts=MIGRAINES.map(x=>new Date(x).getTime()).sort((a,b)=>b-a), day=864e5;
  const within=ms=>ts.filter(t=>now-t<=ms).length;
  h24.textContent=within(day); h7.textContent=within(7*day); h30.textContent=within(30*day);
  historyList.innerHTML=ts.slice(0,5).map(t=>{
    const dt=new Date(t); const time=dt.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
    return `<div>${dt.toLocaleDateString()} Â· ${time}</div>`;
  }).join("") || `<div class="text-neutral-500">No events yet</div>`;
}

/* ----- utils ----- */
const name=k=>({stress:"Stress",work:"Workload",hrv:"HRV"})[k]||k;
const toastOnce=()=>{toast.classList.add("opacity-100"); setTimeout(()=>toast.classList.remove("opacity-100"),1100);};
document.getElementById("refresh").onclick=load; load();
</script>
</body>
</html>




